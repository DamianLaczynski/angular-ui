<ui-field
  [fieldType]="'file'"
  [label]="label()"
  [placeholder]="placeholder()"
  [helpText]="helpText()"
  [errorText]="errorText()"
  [required]="required()"
  [disabled]="disabled()"
  [readonly]="readonly()"
  [id]="id()"
  [name]="name()"
  [size]="size()"
  [inputVariant]="inputVariant()"
>
  <!-- Inline Mode (text-input-like) -->
  @if (mode() === 'inline') {
    <div class="input-wrapper" [class]="wrapperClasses">
      <input
        #fileInput
        class="file-input"
        type="file"
        [name]="name()"
        [accept]="accept()"
        [multiple]="multiple()"
        [disabled]="disabled()"
        [required]="required()"
        (change)="onFileInputChange($event)"
      />
      <input
        class="input file-display"
        type="text"
        [id]="id()"
        [value]="displayText()"
        [placeholder]="placeholder()"
        [readonly]="true"
        [disabled]="disabled()"
        [attr.aria-label]="ariaLabel() || label() || 'File input'"
        [attr.aria-describedby]="ariaDescribedBy()"
        [attr.aria-invalid]="!!errorText()"
        (click)="triggerFileInput()"
        (focus)="onFocus($event)"
        (blur)="onBlur($event)"
        (keydown.enter)="triggerFileInput()"
        (keydown.space)="triggerFileInput()"
        tabindex="0"
        role="button"
      />
      @if (!disabled() && !readonly()) {
        <div class="field__actions">
          <!-- Browse Button -->
          <ui-action-button
            [icon]="'document'"
            [size]="size()"
            (click)="triggerFileInput()"
          ></ui-action-button>

          <!-- Clear Button -->
          @if (selectedFiles().length > 0) {
            <ui-action-button
              [icon]="'dismiss'"
              [size]="size()"
              (click)="clear()"
            ></ui-action-button>
          }
        </div>
      }
    </div>
  }

  <!-- Area Mode (drag-and-drop area) -->
  @if (mode() === 'area') {
    <div class="input-wrapper" [class]="wrapperClasses">
      <!-- File Input Area / Drop Zone -->
      <div
        class="file"
        [class]="fileWrapperClasses()"
        (click)="triggerFileInput()"
        (keydown.enter)="triggerFileInput()"
        (keydown.space)="triggerFileInput()"
        tabindex="0"
        [attr.aria-label]="ariaLabel() || label() || 'File upload'"
        [attr.aria-describedby]="ariaDescribedBy()"
        [attr.aria-invalid]="!!errorText()"
        role="button"
      >
        <input
          #fileInput
          class="file-input"
          type="file"
          [id]="id()"
          [name]="name()"
          [accept]="accept()"
          [multiple]="multiple()"
          [disabled]="disabled()"
          [required]="required()"
          (change)="onFileInputChange($event)"
        />

        <!-- Full Drop Zone Display -->
        <ui-icon [icon]="'arrow_upload'" [size]="size()" class="file__icon" />

        <p class="file__text">{{ displayText() }}</p>
        @if (displayHint()) {
          <p class="file__hint">{{ displayHint() }}</p>
        }
      </div>
    </div>
    <!-- Selected Files List -->
    @if (selectedFiles().length > 0) {
      <div class="file-list">
        @for (fileInfo of selectedFiles(); track fileInfo.id) {
          <ui-node
            class="file-list__item"
            [node]="fileInfoToNode(fileInfo)"
            [size]="size()"
            [showSelectionIndicator]="false"
            [asButton]="false"
          >
            <ng-template #before> </ng-template>

            <ng-template #after>
              <div class="file-item__meta">{{ getFileMeta(fileInfo) }}</div>

              <ui-button
                [icon]="'dismiss'"
                [size]="size()"
                appearance="subtle"
                (click)="removeFile($index)"
                [ariaLabel]="'Remove ' + fileInfo.name"
              ></ui-button>
            </ng-template>
          </ui-node>
        }
      </div>
    }
  }
</ui-field>
