<ui-scroll-panel
  #scrollPanel
  [orientation]="orientation()"
  [scrollbarBehavior]="scrollbarBehavior()"
  [maxHeight]="maxHeight()"
  [maxWidth]="maxWidth()"
  [ariaLabel]="ariaLabel() || 'Scrollable container with items'"
  (scroll)="onScroll($event)"
>
  <div #scrollContainer class="scroll-container__content">
    @if (isLoading() && items().length === 0) {
    <div class="scroll-container__loading">
      <ui-loading-state />
    </div>
    } @else if (error()) {
    <div class="scroll-container__error">
      <p>{{ error() }}</p>
    </div>
    } @else if (items().length === 0) {
    <div class="scroll-container__empty">
      <p>No items to display</p>
    </div>
    } @else {
    <div class="scroll-container__items">
      @for (item of items(); track $index; let index = $index) { @if (shouldUseNodeComponent()) {
      @if (mapItemToNode(item, index); as node) {
      <ui-node
        [node]="node"
        [size]="nodeSize()"
        [showSelectionIndicator]="showSelectionIndicator()"
        [indicatorPosition]="indicatorPosition()"
        [appearance]="appearance()"
        [shape]="shape()"
        [asButton]="asButton()"
        [selectOnClick]="selectOnClick()"
        (nodeClick)="onNodeClick($event)"
        (nodeSelect)="onNodeSelect($event)"
      />
      } } @else if (effectiveItemTemplate()) {
      <ng-container
        *ngTemplateOutlet="
                effectiveItemTemplate()!;
                context: { $implicit: item, index: index }
              "
      ></ng-container>
      } @else {
      <div class="scroll-container__item-fallback">{{ item }}</div>
      } }
    </div>

    @if (isLoading() && items().length > 0) {
    <div class="scroll-container__loading-more">
      <ui-loading-state />
    </div>
    } }
  </div>
</ui-scroll-panel>
