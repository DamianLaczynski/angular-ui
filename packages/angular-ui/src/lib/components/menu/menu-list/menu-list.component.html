@if (visible() && hasContent()) {
  <div
    #menuContainer
    [class]="menuClasses()"
    role="menu"
    tabindex="-1"
    cdkTrapFocus
    cdkTrapFocusAutoCapture
    (keydown)="onMenuKeydown($event)"
  >
    @for (section of allSections(); track trackBySectionIndex($index); let sectionIndex = $index) {
      <div [class]="getSectionClasses(section, sectionIndex)">
        @if (section.header) {
          <div [class]="getSectionHeaderClasses()">
            <div class="menu__section-header-text">{{ section.header }}</div>
          </div>
        }
        @for (item of section.items; track trackByItemId($index, item); let itemIndex = $index) {
          <ui-menu
            [triggerVariant]="getItemTriggerVariant(item)"
            [text]="item.label"
            [icon]="item.icon"
            [shortcut]="item.shortcut"
            [menuItems]="item.submenuItems ?? []"
            [menuMaxHeight]="maxHeight()"
            [disabled]="item.disabled ?? false"
            [size]="size()"
            [variant]="'secondary'"
            [appearance]="'subtle'"
            [openAsSubmenu]="true"
            [selected]="item.selected ?? false"
            (menuItemClick)="onRowMenuItemClick($event)"
            (menuOpened)="onRowMenuOpened(item)"
            (primaryClick)="onRowPrimaryClick(item)"
          />
        }
        @if (section.divider && sectionIndex < allSections().length - 1) {
          <ui-divider orientation="horizontal" />
        }
      </div>
    }
  </div>
}
